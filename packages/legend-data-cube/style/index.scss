/**
 * Copyright (c) 2020-present, Goldman Sachs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@import url('ag-grid-community/styles/ag-grid.css');
@import url('ag-grid-community/styles/ag-theme-quartz.css');

// ---------------------------------------- SCROLLBAR ----------------------------------------
// Make sure to configure the scrollbar to be consistent across browsers
// and to make sure OS-native auto-hide scrollbar behavior is suppressed
// See https://stackoverflow.com/questions/38557671/how-to-prevent-scrollbars-from-hiding-on-os-x-without-impacting-windows-users

.data-cube {
  font-size: 12px;

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-corner {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--tw-color-neutral-400);
    border: 3.5px solid transparent;
    background-clip: content-box;
    border-radius: 2px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--tw-color-neutral-500);
    border: 3.5px solid transparent;
    background-clip: content-box;
    border-radius: 2px;
  }

  ::-webkit-scrollbar-thumb:window-inactive {
    background: var(--tw-color-neutral-200);
    border: 3.5px solid transparent;
    background-clip: content-box;
    border-radius: 2px;
  }

  ::-webkit-scrollbar {
    appearance: none;
    width: 10px;
    height: 10px;
  }

  // ---------------------------------------- RESET ----------------------------------------

  input:focus-visible,
  button:focus-visible {
    outline-color: var(--tw-color-sky-600);
    outline-offset: -1px;
    outline-width: 1.5px;
    outline-style: solid;
  }

  .MuiCheckbox-root.Mui-focusVisible svg {
    outline-color: var(--tw-color-sky-600);
    outline-offset: -2px;
    outline-width: 1.5px;
    outline-style: solid;
  }

  .markdown-content {
    margin: 0;
    word-wrap: break-word;
    width: 100%;
  }

  .markdown-content p,
  .markdown-content blockquote,
  .markdown-content ul,
  .markdown-content ol,
  .markdown-content dl,
  .markdown-content table,
  .markdown-content pre,
  .markdown-content details {
    margin-top: 0;
    margin-bottom: 10px;
  }

  .markdown-content [hidden] {
    display: none !important;
  }

  .markdown-content a {
    background: transparent;
    color: var(--tw-color-sky-500);
    text-decoration: none;
  }

  .markdown-content a:active,
  .markdown-content a:hover {
    outline-width: 0;
  }

  .markdown-content abbr[title] {
    border-bottom: none;
    text-decoration: underline dotted;
  }

  .markdown-content b,
  .markdown-content strong {
    font-weight: 700;
  }

  .markdown-content dfn {
    font-style: italic;
  }

  .markdown-content h1 {
    margin: 20px 0 10px;
    font-weight: 700;
    padding-bottom: 2px;
    font-size: 16px;
    border-bottom: 1px solid var(--tw-color-neutral-200);
  }

  .markdown-content code {
    font-family: 'Roboto Mono', monospace;
    padding: 2px 4px;
    margin: 0;
    font-size: 12px;
    background: var(--tw-color-neutral-200);
    border-radius: 2px;
  }

  .markdown-content code br {
    display: none;
  }

  .markdown-content del code {
    text-decoration: inherit;
  }

  .markdown-content pre > code {
    padding: 0;
    margin: 0;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
  }

  .markdown-content pre {
    margin-top: 0;
    margin-bottom: 0;
    font-family: 'Roboto Mono', monospace;
    word-wrap: normal;
    overflow: auto;
    font-size: 12px;
    line-height: 1.45;
    background: var(--tw-color-neutral-100);
    border-radius: 2px;
  }

  .markdown-content pre code {
    display: inline;
    padding: 0;
    margin: 0;
    overflow: visible;
    line-height: inherit;
    word-wrap: normal;
    background: transparent;
    border: 0;
    font-size: 12px;
  }

  .markdown-content blockquote {
    padding: 0 10px;
    color: var(--tw-color-neutral-500);
    border-left: 3px solid var(--tw-color-neutral-200);
  }
}

// ---------------------------------------- CUSTOMIZE ----------------------------------------

.data-cube-editor-checkbox--checked svg {
  color: var(--tw-color-neutral-600);
}

.data-cube-editor-checkbox--disabled svg {
  color: var(--tw-color-neutral-300);
}

.data-cube-color-picker {
  .react-colorful {
    width: 270px;
    height: 100px;
    border-radius: 2px;
    border: 0.5px solid var(--tw-color-neutral-600);
  }

  .react-colorful__saturation {
    border-radius: 2px 2px 0 0;
  }

  .react-colorful__pointer {
    width: 12px;
    height: 12px;
  }

  .react-colorful__hue {
    height: 12px;
  }

  .react-colorful__last-control {
    border-radius: 0 0 2px 2px;
    height: 12px;
  }
}

.data-cube-color-picker--disabled {
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100' %3E%3Cpath d='M0 0 L100 100' stroke-width='4' stroke='%23e5e5e5' /%3E%3C/svg%3E");
}

.data-cube-color-picker--transparent {
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100' %3E%3Cpath d='M0 100 L100 0' stroke-width='7' stroke='%23ef4444' /%3E%3C/svg%3E");
}

.data-cube-grid__utility--pivot-column-group {
  padding: 0 0 0 4px;
  border: 1px solid var(--tw-color-neutral-400);
}
// following is the color rotation used to alternate the color of pivot result columns
// TODO?: should we make it more programatic?
.data-cube-grid__utility--pivot-column-group-0 {
  background: linear-gradient(
    var(--tw-color-blue-200),
    var(--tw-color-blue-50)
  );
}

.data-cube-grid__utility--pivot-column-group-1 {
  background: linear-gradient(
    var(--tw-color-emerald-200),
    var(--tw-color-emerald-50)
  );
}

.data-cube-grid__utility--pivot-column-group-2 {
  background: linear-gradient(
    var(--tw-color-rose-200),
    var(--tw-color-rose-50)
  );
}

.data-cube-grid__utility--pivot-column-group-3 {
  background: linear-gradient(
    var(--tw-color-teal-200),
    var(--tw-color-teal-50)
  );
}

.data-cube-grid__utility--pivot-column-group-4 {
  background: linear-gradient(
    var(--tw-color-yellow-200),
    var(--tw-color-yellow-50)
  );
}

.data-cube-grid.ag-theme-quartz,
.data-cube-grid .ag-theme-quartz {
  --ag-card-radius: 0;
  --ag-active-color: var(--tw-color-sky-600);
  --ag-range-selection-border-color: var(--tw-color-sky-600);
  --ag-range-selection-highlight-color: var(
    --tw-color-sky-50
  ); // color for the brief highlight animation when cells are copied

  --ag-border-color: var(--tw-color-neutral-200);
  --ag-header-background-color: var(--tw-color-neutral-100);
  --ag-header-height: 24px;
  --ag-row-height: 20px;
  --ag-font-size: 12px;
  --ag-grid-size: 1px;
  --ag-icon-size: 12px;
  --ag-font-family: 'Roboto', sans-serif;
  --ag-icon-font-color: var(--tw-color-neutral-500);
  --ag-header-foreground-color: var(--tw-color-black);
  --ag-row-hover-color: #d4d4d415; // from tailwind neutral 300
  --ag-popup-shadow: 2px 2px 5px rgb(0 0 0 / 20%);
  --ag-header-column-resize-handle-width: 1px;
  --ag-background-color: var(--tw-color-white);
  --ag-menu-background-color: var(--tw-color-white);
  --ag-menu-border-color: var(--tw-color-neutral-300);
  --ag-border-radius: 0;
  --ag-input-focus-box-shadow: none;
  --ag-input-focus-border-color: var(--tw-color-sky-600);

  // tooltip
  --ag-tooltip-background-color: var(--tw-color-white);

  // side bar and drop zones
  --ag-icon-font-code-group: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' class='icon icon-tabler icon-tabler-table-column' width='12' height='12' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23000000' fill='none' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath stroke='none' d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M3 5a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-14z' /%3E%3Cpath d='M10 10h11' /%3E%3Cpath d='M10 3v18' /%3E%3Cpath d='M9 3l-6 6' /%3E%3Cpath d='M10 7l-7 7' /%3E%3Cpath d='M10 12l-7 7' /%3E%3Cpath d='M10 17l-4 4' /%3E%3C/svg%3E");
  --ag-icon-font-code-pivot: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' class='icon icon-tabler icon-tabler-table-row' width='12' height='12' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23000000' fill='none' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath stroke='none' d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M3 5a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-14z' /%3E%3Cpath d='M9 3l-6 6' /%3E%3Cpath d='M14 3l-7 7' /%3E%3Cpath d='M19 3l-7 7' /%3E%3Cpath d='M21 6l-4 4' /%3E%3Cpath d='M3 10h18' /%3E%3Cpath d='M10 10v11' /%3E%3C/svg%3E");
  --ag-icon-font-code-columns: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' class='icon icon-tabler icon-tabler-columns-3' width='12' height='12' viewBox='0 0 24 24' stroke-width='1.5' stroke='black' fill='none' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath stroke='none' d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M3 3m0 1a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1zm6 -1v18m6 -18v18' /%3E%3C/svg%3E");
  --ag-control-panel-background-color: var(--tw-color-neutral-100);
  --ag-widget-container-horizontal-padding: 4px;
  --ag-widget-container-vertical-padding: 4px;
  --ag-list-item-height: 18px;
  --ag-widget-horizontal-spacing: 4px;
  --ag-widget-vertical-spacing: 4px;
  --ag-wrapper-border-radius: 0;

  // --------------------------------- Generic ---------------------------------

  .ag-icon:hover {
    box-shadow: none;
  }

  // Make sure the full-width loader is not causing the grid to jump when its width
  // not spanning the full width of the screen
  // See https://www.ag-grid.com/javascript-data-grid/component-loading-cell-renderer/#full-width-loading-row
  .ag-full-width-row {
    background-color: transparent;
  }

  // --------------------------------- Pinning ---------------------------------
  // Improve visibility of pinned columns

  .ag-sticky-top .ag-pinned-left-sticky-top > div,
  .ag-sticky-top .ag-sticky-top-container > div {
    border-bottom: 3px double var(--tw-color-neutral-400);
  }

  .ag-cell.ag-cell-last-left-pinned {
    border-right: none;
  }

  .ag-pinned-left-sticky-top,
  .ag-pinned-left-header,
  .ag-pinned-left-cols-container {
    border-right: 3px double var(--tw-color-neutral-400);
  }

  .ag-cell.ag-cell-first-right-pinned {
    border-left: none;
  }

  .ag-pinned-right-sticky-top,
  .ag-pinned-right-header,
  .ag-pinned-right-cols-container {
    border-left: 3px double var(--tw-color-neutral-400);
  }

  // --------------------------------- Tooltip ---------------------------------
  // Improve visibility of tooltips

  .ag-tooltip {
    padding: 3px 5px;
    border: 1px solid var(--tw-color-neutral-500);
    border-radius: 0;
  }

  .ag-tooltip.ag-tooltip-animate,
  .ag-tooltip-custom.ag-tooltip-animate {
    transition: opacity 0.2s;
  }

  // --------------------------------- Header ---------------------------------

  .ag-header-cell-label .ag-sort-order {
    font-size: 10px;
    margin-left: 5px;
    margin-right: -2px;
    color: var(--tw-color-neutral-500);
    font-weight: 500;
  }

  .ag-header-cell-menu-button:hover {
    background-color: transparent;
    box-shadow: none;
  }

  // --------------------------------- Context Menu ---------------------------------
  .ag-menu {
    // Gives more spacing to the menu compared to the grid where we favors compactness
    --ag-grid-size: 3px;
  }

  .ag-menu-list {
    min-width: 120px;
  }

  .ag-menu-option {
    cursor: default;
    font-weight: initial;
  }

  .ag-menu-option-active {
    background-color: var(--tw-color-neutral-100);
  }

  // --------------------------------- Side Bar + Drop Zone (for pivoting) ---------------------------------
  // These are styling for the row grouping and pivot drop zones / panels on top of the grid and the side bar
  // NOTE: we need to do some CSS hacking to rename some terminology hard-coded with ag-grid:
  // e.g. row group -> vertical pivot, column label -> horizontal pivot
  //
  // These styles, therefore, are farily fragile and should be frequently reviewed when upgrading ag-grid

  // NOTE: These are icons taken from Tabler and URI encoded
  // See https://yoksel.github.io/url-encoder/
  // See https://tablericons.com/
  // See https://github.com/tabler/tabler-icons

  .ag-column-drop-cell {
    height: 16px;
    display: flex;
    align-items: center;
    border-radius: 3px;

    .ag-column-drop-cell-text {
      height: 16px;
      line-height: 16px;
      color: var(--ag-secondary-foreground-color);
    }
  }

  .ag-side-bar {
    background: var(--tw-color-neutral-100);
  }

  .ag-column-panel {
    .ag-column-select-header-filter-wrapper .ag-input-wrapper::before {
      margin-left: 3px;
    }

    .ag-input-field-input.ag-text-field-input {
      padding: 2px 2px 2px 18px;
      font-size: 10px;
    }
  }

  .ag-column-drop-title-bar.ag-column-drop-vertical-title-bar {
    border-bottom: 1px solid var(--ag-border-color);
    padding-bottom: var(--ag-grid-size);
    margin-bottom: var(--ag-grid-size);
  }

  .ag-column-drop {
    // Gives more spacing to the tool panel compared to the grid where we favors compactness
    --ag-grid-size: 3px;
  }

  .ag-column-drop-vertical {
    padding-top: var(--ag-grid-size);
  }

  // ---------------------------------------------------------------------------
  // NOTE: These following styles hacks the hard-coded terminology in ag-grid
  // They are brittle and should be reviewed when upgrading ag-grid

  .ag-column-drop-empty-message.ag-column-drop-horizontal-empty-message {
    font-size: 0;
    color: var(--ag-disabled-foreground-color);
  }

  .ag-column-drop-list.ag-column-drop-horizontal-list {
    overflow-x: auto;
  }

  .ag-column-drop-list.ag-column-drop-horizontal-list[aria-label='Row Groups']
    .ag-column-drop-empty-message.ag-column-drop-horizontal-empty-message::after {
    content: 'Drag columns here to set vertical pivots';
    font-size: 11px;
  }

  .ag-column-drop-list.ag-column-drop-horizontal-list[aria-label='Column Labels']
    .ag-column-drop-empty-message.ag-column-drop-horizontal-empty-message::after {
    content: 'Drag columns here to set horizontal pivots';
    font-size: 11px;
  }

  .ag-column-drop-title-bar.ag-column-drop-vertical-title-bar
    .ag-column-drop-title.ag-column-drop-vertical-title {
    font-size: 0;
  }

  .ag-column-drop-title-bar.ag-column-drop-vertical-title-bar
    .ag-icon.ag-icon-group
    + span::after {
    content: 'Vertical Pivots';
    font-size: 11px;
  }

  .ag-column-drop-title-bar.ag-column-drop-vertical-title-bar
    .ag-icon.ag-icon-pivot
    + span::after {
    content: 'Horizontal Pivots';
    font-size: 11px;
  }

  .ag-column-drop-empty-message.ag-column-drop-vertical-empty-message {
    font-size: 0;
    padding-top: 5px;
  }

  .ag-column-drop-list.ag-column-drop-vertical-list[aria-label='Row Groups']
    .ag-column-drop-empty-message.ag-column-drop-vertical-empty-message::after,
  .ag-column-drop-list.ag-column-drop-vertical-list[aria-label='Column Labels']
    .ag-column-drop-empty-message.ag-column-drop-vertical-empty-message::after {
    content: 'Drag columns here to set pivots';
    font-size: 11px;
    font-weight: initial;
  }
  // ---------------------------------------------------------------------------
}

// ---------------------------------------- Editor Column Selector ----------------------------------------

.data-cube-column-selector .ag-theme-quartz {
  --ag-active-color: var(--tw-color-sky-600);
  --ag-input-focus-border-color: var(--tw-color-sky-600);
  --ag-range-selection-border-color: var(--tw-color-sky-600);
  --ag-selected-row-background-color: var(--tw-color-sky-100);
  --ag-border-color: var(--tw-color-white);
  --ag-header-background-color: var(--tw-color-white);
  --ag-header-height: 20px;
  --ag-row-height: 20px;
  --ag-font-size: 12px;
  --ag-grid-size: 1px;
  --ag-icon-size: 12px;
  --ag-font-family: 'Roboto', sans-serif;
  --ag-icon-font-color: var(--tw-color-neutral-500);
  --ag-row-border-color: transparent;
  --ag-header-foreground-color: var(--tw-color-black);
  --ag-row-hover-color: #d4d4d415; // tailwind neutral 300
  --ag-header-column-separator-display: none;
  --ag-wrapper-border-radius: 0;

  // ag-grid header always comes with a big padding, we want to suppress that
  .ag-header-cell:focus-visible::after {
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
  }

  .ag-drag-handle.ag-row-drag {
    margin-right: 5px;
  }
}

// --------------------------------- Editor Date Calendar ---------------------------------

.data-cube-editor-date-calendar {
  .MuiDateCalendar-root * {
    font-size: 10px;
  }

  .MuiYearCalendar-root {
    width: 190px;
    height: 160px;
  }

  .MuiDateCalendar-root {
    width: 190px;
    height: 210px;
  }

  .MuiPickersCalendarHeader-root {
    margin-top: 10px;
    padding-left: 17px;
    padding-right: 11px;
    min-height: 32px;
    max-height: 32px;
  }

  .MuiPickersCalendarHeader-label {
    font-size: 11px;
  }

  .MuiPickersDay-today:not(.Mui-selected) {
    border: 1px solid var(--tw-color-neutral-500);
  }

  .MuiPickersCalendarHeader-switchViewIcon,
  .MuiPickersArrowSwitcher-leftArrowIcon,
  .MuiPickersArrowSwitcher-rightArrowIcon {
    font-size: 12px;
  }

  .MuiPickersYear-yearButton:focus,
  .MuiPickersYear-yearButton:hover,
  .MuiPickersDay-root:focus,
  .MuiPickersDay-root:hover {
    background-color: var(--tw-color-sky-50);
  }

  .MuiPickersYear-yearButton.Mui-selected,
  .MuiPickersYear-yearButton.Mui-selected:focus,
  .MuiPickersYear-yearButton.Mui-selected:hover,
  .MuiPickersDay-root.Mui-selected,
  .MuiPickersDay-root.Mui-selected:focus,
  .MuiPickersDay-root.Mui-selected:hover {
    background-color: var(--tw-color-sky-600);
  }

  .MuiPickersCalendarHeader-switchViewButton,
  .MuiPickersArrowSwitcher-button,
  .MuiDayCalendar-weekDayLabel,
  .MuiPickersDay-root {
    height: 20px;
    width: 20px;
    border-radius: 0;
  }

  .MuiPickersYear-yearButton,
  .MuiPickersYear-root {
    height: 20px;
    width: 30px;
    border-radius: 0;
  }

  .MuiPickersSlideTransition-root {
    min-height: 140px;
  }
}
